<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fuel Calculator</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<h1 class="page-title">62's Fuel Calculator</h1>

<div class="login-wrapper">
  <form class="login-form" id="login-form" action="/login" method="post"> <!-- Updated action attribute -->
    <h2>Login</h2>
    <div class="input-box">
      <input type="text" id="username" name="username" placeholder="Username" maxlength="20" required> <!-- Added maxlength attribute -->
      <span class="error" id="username-error"></span> <!-- Error message for username -->
    </div>
    <div class="input-box">
      <input type="password" id="password" name="password" placeholder="Password" required> <!-- Added name attribute -->
      <span class="error" id="password-error"></span> <!-- Error message for password -->
    </div>
    <button type="submit" class="btn">Login</button>
  </form>
  <p class="registration-link">Need to register? <a href="register.html">click here</a></p>
</div>

<script>
  document.getElementById("profile-form").addEventListener("submit", function(event) {
    event.preventDefault(); // Prevent the default form submission

    // Collect form data
    const formData = new FormData(document.getElementById("profile-form"));
    
    // Convert form data to JSON object
    const jsonData = {};
    formData.forEach((value, key) => {
      jsonData[key] = value;
    });

    // Send form data to the server
    fetch("/client/profiles", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(jsonData)
    })
    .then(response => {
      if (!response.ok) {
        throw new Error("Network response was not ok");
      }
      return response.json();
    })
    .then(data => {
      alert("Profile submitted successfully!");
      // Optionally, handle the response from the server
      console.log(data);
    })
    .catch(error => {
      console.error("Error:", error);
      alert("An error occurred while submitting the profile. Please try again.");
    });
  });
</script>

</body>
</html>